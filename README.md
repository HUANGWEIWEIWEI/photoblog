# photoblog
Vue.js+node(express)全栈开发《格调映画》摄影博客-源码 
> 本网站项目线上访问地址： [格调映画](https://pblog.dignified.cn) 

## 一、 服务端server
1. 做了给管理后台的通用的增删改查接口，upload接口以及登录校验
1. 做了给前端页面的文章列表和文章详情接口(文章分为摄影、摄像、教程)
1. 在服务端定义了系统需要用到的6个mongodb的schema
1. 数据表AdminUser包含account和pwd，供管理员后台登录
1. 数据表Category包含name和parent，parent通过ID关联对应的父Category表
1. 数据表Article包含title,body,create,tags,categories,meta和commend，其中tags,categories通过ID关联对应的数据库，create,tags,categories,meta和commend对应系统前端页面暂未开发相关功能，待用户注册与登录功能完善再做进一步改进
1. 数据表User、Gift、Tag暂时只在后台做了相应的对接，待技术长进再做前端页面的相应开发


## 二、 管理后台admin
1. 管理后台系统基于Element UI搭建
1. 主要分为3大板块，内容管理、运营管理和账号管理
1. 内容管理包括了文章、分类、标签和精选部分的增删改查和列表展示，这里的精选可以是广告、轮播图或者友站推荐等一些小元素
1. 运营管理包括评论和留言的增删改查和列表展示
1. 账号管理包括管理员账号和用户账号的增删改查和列表展示
1. 安装路由插件router,未使用 history mode
1. 创建了axios实例http用于数据请求
1. 文件上传，用multer让express能获取到上传文件的数据
1. 文章详情编辑使用了富文本编辑器(quill)，这里使用的是vue-2-editor
1. 用卡片组件写了登录页面
1. 管理员账号使用了bcrypt给密码散列加密，比md5加密还要安全
1. 登录接口 (jwt,jsonwebtoken)，jsonwebtoken用于webtoken验证，由服务端进行登录校验
1. 后台页面的路由限制使用beforeEach, meta；对上传文件也进行了登录校验

## 三、前端页面web

1. 完成了对页面顶部公共部分、页脚以及卡片组件的封装
1. 网站分为首页、摄影、摄像、教程、关于这五个部分
1. 首页和关于部分为纯静态页面，其余可动态请求服务端数据
1. 首页和关于页面展示了部分作品与个人联系方式以及个人履历
1. 引入了轮播图组件vue-awesome-swiper做首页和关于页面图片展示
1. 另外还使用了elementUI的Container布局容器和⾃定义时间戳
1. 用SASS(SCSS)封装了常用的工具类样式
1. 摄影、摄像、教程页面架构类似，除公共的页眉和页脚组件外，都给了一个对应的文章列表，还给出了其对应的子分类，这里也用到了滑动组件
1. 摄影、摄像、教程的详情页面展示了文章标题、内容和相关文章推荐
1. 完成了摄影、摄像、教程页面以及对应详情页面用于获取服务端数据的数据接口，通过axios做对应的数据请求


## 四、待完善的功能

1. 显示文章创建时间
1. 用户注册与登录
1. 用户的留言功能以及对文章的点赞评论功能
1. 第三方登录功能
1. 让轮播图的图片可以通过请求后端数据获得
1. 在前端页面添加精选小组件诸如友站推荐、好站推荐


## 五、项目上线过程

1. 在VS Code进行从开发环境转向生产环境的编译
1. 购买域名(huangweiphoto.cn)和服务器，做好域名解析，这里选择了腾讯云服务器
1. 在服务器上完成web服务器(Nginx)的安装和配置
1. 在服务器上完成MongoDB数据库的安装和配置
1. 在服务器上完成git的安装，并配置ssh-key
1. 在服务器上完成Node.js的安装，配置淘宝镜像，安装nrm便于快速切换镜像
1. 把本地代码上传到git服务器上（github/码云），然后在git服务器上（github/码云）拉代码到用于上线的服务器，在服务器上安装pm2并启动项目
1. 配置 Nginx 的反向代理，直接在vs code里安装remote ssh拓展进行远程操作
1. 迁移本地数据到服务器 (mongodump)，学习对robot3d的使用
1. 使用免费SSL证书启用网站的HTTPS安全连接，在此我选用的是Let's encrypt
1. 使用阿里云对象存储OOS存放上传文件

## 六、上线后优化记录
1. 将首页和关于轮播图片地址链接到阿里云OSS
1. 页眉页脚界面和链接优化

## 七、下载代码本地运行
1. 在终端打开web和admin文件夹分别运行npm i，再分别进入三个文件夹，分别运行npm run serve,打开web和admin终端给的地址即可
1. 进入admin后台管理系统登录验证，需要你在本地建一个名为photoblog的MongoDB数据库，新建数据表AdminUser设置account和pwd，以此登录
1. 由于上传文件到OSS阿里云涉及账户安全问题，/photoblog/server/router/admin/index.js代码已被注释修改，仅展示上传文件到服务端再返回前示这端显部分

